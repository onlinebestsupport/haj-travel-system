<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backup - Alhudha Haj Travel Admin</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .backup-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .backup-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .backup-card i {
            font-size: 2.5rem;
            color: #3498db;
            margin-bottom: 10px;
        }
        
        .backup-card h3 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .backup-size {
            font-size: 1.5rem;
            font-weight: bold;
            color: #27ae60;
        }
        
        .backup-list {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        .backup-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
        }
        
        .backup-item:last-child {
            border-bottom: none;
        }
        
        .backup-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .backup-info i {
            font-size: 1.5rem;
            color: #3498db;
        }
        
        .backup-details h4 {
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .backup-details p {
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .backup-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-backup {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .btn-backup:hover {
            background: #219a52;
            transform: translateY(-2px);
        }
        
        .btn-restore {
            background: #f39c12;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .btn-restore:hover {
            background: #e67e22;
        }
        
        .btn-download {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .btn-download:hover {
            background: #2980b9;
        }
        
        .btn-delete {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .btn-delete:hover {
            background: #c0392b;
        }
        
        .schedule-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .schedule-card h3 {
            color: white;
            margin-bottom: 20px;
        }
        
        .schedule-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .schedule-option {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .schedule-option:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }
        
        .schedule-option i {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .schedule-option.active {
            background: #f1c40f;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="admin-header">
        <div class="container">
            <div class="header-content">
                <div class="logo-area">
                    <i class="fas fa-kaaba"></i>
                    <h1>Alhudha Haj Admin - Backup</h1>
                    <span class="role-badge" id="roleBadge">Admin</span>
                </div>
                <button onclick="logout()" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="page-header">
            <h2><i class="fas fa-database"></i> Database Backup & Restore</h2>
            <button class="btn-backup" onclick="createBackup()">
                <i class="fas fa-save"></i> Create New Backup
            </button>
        </div>

        <!-- Backup Statistics -->
        <div class="backup-stats">
            <div class="backup-card">
                <i class="fas fa-database"></i>
                <h3>Database Size</h3>
                <div class="backup-size" id="dbSize">2.4 MB</div>
            </div>
            <div class="backup-card">
                <i class="fas fa-file-archive"></i>
                <h3>Total Backups</h3>
                <div class="backup-size" id="totalBackups">12</div>
            </div>
            <div class="backup-card">
                <i class="fas fa-clock"></i>
                <h3>Last Backup</h3>
                <div class="backup-size" id="lastBackup">2026-02-21</div>
            </div>
            <div class="backup-card">
                <i class="fas fa-hdd"></i>
                <h3>Storage Used</h3>
                <div class="backup-size" id="storageUsed">156 MB</div>
            </div>
        </div>

        <!-- Backup List -->
        <div class="backup-list">
            <h3 style="margin-bottom: 20px;">Available Backups</h3>
            <div id="backupItems">
                <!-- Backup items will be loaded here -->
                <div class="backup-item">
                    <div class="backup-info">
                        <i class="fas fa-file-archive"></i>
                        <div class="backup-details">
                            <h4>Full Backup - 2026-02-21 03:00 AM</h4>
                            <p>Size: 2.4 MB | Tables: 4 | Status: Completed</p>
                        </div>
                    </div>
                    <div class="backup-actions">
                        <button class="btn-restore" onclick="restoreBackup('backup1')">
                            <i class="fas fa-undo"></i> Restore
                        </button>
                        <button class="btn-download" onclick="downloadBackup('backup1')">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button class="btn-delete" onclick="deleteBackup('backup1')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
                <div class="backup-item">
                    <div class="backup-info">
                        <i class="fas fa-file-archive"></i>
                        <div class="backup-details">
                            <h4>Full Backup - 2026-02-20 03:00 AM</h4>
                            <p>Size: 2.3 MB | Tables: 4 | Status: Completed</p>
                        </div>
                    </div>
                    <div class="backup-actions">
                        <button class="btn-restore" onclick="restoreBackup('backup2')">
                            <i class="fas fa-undo"></i> Restore
                        </button>
                        <button class="btn-download" onclick="downloadBackup('backup2')">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button class="btn-delete" onclick="deleteBackup('backup2')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
                <div class="backup-item">
                    <div class="backup-info">
                        <i class="fas fa-file-archive"></i>
                        <div class="backup-details">
                            <h4>Full Backup - 2026-02-19 03:00 AM</h4>
                            <p>Size: 2.3 MB | Tables: 4 | Status: Completed</p>
                        </div>
                    </div>
                    <div class="backup-actions">
                        <button class="btn-restore" onclick="restoreBackup('backup3')">
                            <i class="fas fa-undo"></i> Restore
                        </button>
                        <button class="btn-download" onclick="downloadBackup('backup3')">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button class="btn-delete" onclick="deleteBackup('backup3')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Auto Backup Schedule -->
        <div class="schedule-card">
            <h3><i class="fas fa-clock"></i> Automatic Backup Schedule</h3>
            <div class="schedule-options">
                <div class="schedule-option" onclick="setSchedule('daily')">
                    <i class="fas fa-calendar-day"></i>
                    <h4>Daily</h4>
                    <p>Every day at 3 AM</p>
                </div>
                <div class="schedule-option active" onclick="setSchedule('weekly')">
                    <i class="fas fa-calendar-week"></i>
                    <h4>Weekly</h4>
                    <p>Every Sunday at 3 AM</p>
                </div>
                <div class="schedule-option" onclick="setSchedule('monthly')">
                    <i class="fas fa-calendar-alt"></i>
                    <h4>Monthly</h4>
                    <p>1st of every month</p>
                </div>
                <div class="schedule-option" onclick="setSchedule('manual')">
                    <i class="fas fa-hand"></i>
                    <h4>Manual Only</h4>
                    <p>No automatic backup</p>
                </div>
            </div>
        </div>

        <!-- Backup Settings -->
        <div class="dashboard-card" style="margin-top: 30px;">
            <h3><i class="fas fa-cog"></i> Backup Settings</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label>Keep backups for</label>
                    <select id="retentionDays">
                        <option value="7">7 days</option>
                        <option value="30" selected>30 days</option>
                        <option value="60">60 days</option>
                        <option value="90">90 days</option>
                        <option value="365">1 year</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Backup location</label>
                    <select id="backupLocation">
                        <option value="local">Local server</option>
                        <option value="cloud">Cloud storage</option>
                        <option value="both">Both local and cloud</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Compression level</label>
                    <select id="compression">
                        <option value="fast">Fast (low compression)</option>
                        <option value="normal" selected>Normal</option>
                        <option value="max">Maximum (slow)</option>
                    </select>
                </div>
            </div>
            <div class="form-actions">
                <button class="action-btn btn-primary" onclick="saveSettings()">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>
    </div>

    <script>
        // Check authentication
        document.addEventListener('DOMContentLoaded', function() {
            if (!sessionStorage.getItem('adminLoggedIn')) {
                window.location.href = '/admin.login.html';
            }
            loadBackupData();
        });

        function logout() {
            sessionStorage.clear();
            window.location.href = '/admin.login.html';
        }

        function loadBackupData() {
            // Load backup statistics from API
            // This is demo data - replace with actual API calls
            document.getElementById('dbSize').textContent = '2.4 MB';
            document.getElementById('totalBackups').textContent = '12';
            document.getElementById('lastBackup').textContent = '2026-02-21';
            document.getElementById('storageUsed').textContent = '156 MB';
        }

        function createBackup() {
            showNotification('Creating backup...', 'info');
            
            // Simulate backup creation
            setTimeout(() => {
                showNotification('Backup created successfully!', 'success');
                // Add new backup to list
                addBackupToList();
            }, 2000);
        }

        function addBackupToList() {
            const backupList = document.getElementById('backupItems');
            const today = new Date().toISOString().split('T')[0];
            const now = new Date().toLocaleTimeString();
            
            const newBackup = document.createElement('div');
            newBackup.className = 'backup-item';
            newBackup.innerHTML = `
                <div class="backup-info">
                    <i class="fas fa-file-archive"></i>
                    <div class="backup-details">
                        <h4>Full Backup - ${today} ${now}</h4>
                        <p>Size: 2.4 MB | Tables: 4 | Status: Completed</p>
                    </div>
                </div>
                <div class="backup-actions">
                    <button class="btn-restore" onclick="restoreBackup('new')">
                        <i class="fas fa-undo"></i> Restore
                    </button>
                    <button class="btn-download" onclick="downloadBackup('new')">
                        <i class="fas fa-download"></i> Download
                    </button>
                    <button class="btn-delete" onclick="deleteBackup(this)">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            `;
            
            backupList.insertBefore(newBackup, backupList.firstChild);
        }

        function restoreBackup(backupId) {
            if (confirm('Are you sure you want to restore this backup? Current data will be overwritten.')) {
                showNotification('Restoring backup...', 'info');
                
                setTimeout(() => {
                    showNotification('Backup restored successfully!', 'success');
                }, 3000);
            }
        }

        function downloadBackup(backupId) {
            showNotification('Downloading backup...', 'info');
            
            // Simulate download
            setTimeout(() => {
                showNotification('Backup downloaded successfully!', 'success');
            }, 1500);
        }

        function deleteBackup(button) {
            if (confirm('Are you sure you want to delete this backup?')) {
                const backupItem = button.closest('.backup-item');
                backupItem.remove();
                showNotification('Backup deleted successfully!', 'success');
            }
        }

        function setSchedule(type) {
            document.querySelectorAll('.schedule-option').forEach(opt => {
                opt.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            showNotification(`Backup schedule set to ${type}`, 'success');
        }

        function saveSettings() {
            const retention = document.getElementById('retentionDays').value;
            const location = document.getElementById('backupLocation').value;
            const compression = document.getElementById('compression').value;
            
            showNotification('Backup settings saved successfully!', 'success');
        }

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i> ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                background: ${type === 'success' ? '#27ae60' : type === 'error' ? '#e74c3c' : '#3498db'};
                color: white;
                border-radius: 5px;
                z-index: 9999;
                animation: slideIn 0.3s ease;
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Add animation style
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
