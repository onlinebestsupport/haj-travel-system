<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email - Alhudha Haj Travel Admin</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .email-container {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
            height: calc(100vh - 200px);
            min-height: 600px;
        }
        
        .email-sidebar {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        .compose-btn {
            width: 100%;
            padding: 15px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s;
        }
        
        .compose-btn:hover {
            background: #219a52;
        }
        
        .folder-list {
            list-style: none;
        }
        
        .folder-item {
            padding: 12px 15px;
            margin-bottom: 5px;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #2c3e50;
            transition: all 0.3s;
        }
        
        .folder-item:hover {
            background: #f0f0f0;
        }
        
        .folder-item.active {
            background: #e8f4f8;
            color: #3498db;
            font-weight: 600;
        }
        
        .folder-item i {
            width: 20px;
        }
        
        .badge {
            margin-left: auto;
            background: #e74c3c;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
        }
        
        .email-list {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .email-toolbar {
            padding: 15px 20px;
            border-bottom: 1px solid #ecf0f1;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .email-toolbar button {
            padding: 8px 15px;
            background: none;
            border: none;
            cursor: pointer;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 5px;
            border-radius: 5px;
        }
        
        .email-toolbar button:hover {
            background: #f0f0f0;
        }
        
        .email-search {
            flex: 1;
            display: flex;
            gap: 10px;
        }
        
        .email-search input {
            flex: 1;
            padding: 8px 15px;
            border: 2px solid #ecf0f1;
            border-radius: 5px;
        }
        
        .email-items {
            flex: 1;
            overflow-y: auto;
        }
        
        .email-item {
            display: grid;
            grid-template-columns: 30px 200px 300px 1fr 100px;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #ecf0f1;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .email-item:hover {
            background: #f8f9fa;
        }
        
        .email-item.unread {
            background: #f0f7ff;
            font-weight: 600;
        }
        
        .email-item.unread .email-sender {
            font-weight: 600;
        }
        
        .email-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .email-star {
            color: #f1c40f;
            cursor: pointer;
        }
        
        .email-star:hover {
            color: #f39c12;
        }
        
        .email-sender {
            font-weight: 500;
        }
        
        .email-subject {
            color: #2c3e50;
        }
        
        .email-preview {
            color: #7f8c8d;
            font-size: 0.9rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .email-date {
            text-align: right;
            color: #95a5a6;
            font-size: 0.85rem;
        }
        
        .attachment-icon {
            color: #95a5a6;
            margin-left: 5px;
        }
        
        .compose-modal {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 500px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }
        
        .compose-header {
            padding: 15px 20px;
            background: #2c3e50;
            color: white;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .compose-header h3 {
            color: white;
            margin: 0;
        }
        
        .compose-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .compose-body {
            padding: 20px;
        }
        
        .compose-body input,
        .compose-body textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 2px solid #ecf0f1;
            border-radius: 5px;
        }
        
        .compose-body textarea {
            height: 200px;
            resize: vertical;
        }
        
        .compose-footer {
            padding: 15px 20px;
            border-top: 1px solid #ecf0f1;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .template-selector {
            position: fixed;
            bottom: 20px;
            right: 540px;
            width: 300px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            padding: 15px;
            display: none;
        }
        
        .template-item {
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .template-item:hover {
            background: #e8f4f8;
        }
    </style>
</head>
<body>
    <div class="admin-header">
        <div class="container">
            <div class="header-content">
                <div class="logo-area">
                    <i class="fas fa-kaaba"></i>
                    <h1>Alhudha Haj Admin - Email</h1>
                    <span class="role-badge" id="roleBadge">Admin</span>
                </div>
                <button onclick="logout()" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="page-header">
            <h2><i class="fas fa-envelope"></i> Email Communication</h2>
            <div>
                <button class="action-btn btn-primary" onclick="checkEmails()">
                    <i class="fas fa-sync"></i> Check Mail
                </button>
                <button class="action-btn btn-success" onclick="openSettings()">
                    <i class="fas fa-cog"></i> Settings
                </button>
            </div>
        </div>

        <!-- Email Interface -->
        <div class="email-container">
            <!-- Sidebar -->
            <div class="email-sidebar">
                <button class="compose-btn" onclick="openCompose()">
                    <i class="fas fa-pen"></i> Compose
                </button>
                
                <ul class="folder-list">
                    <li class="folder-item active" onclick="selectFolder('inbox')">
                        <i class="fas fa-inbox"></i> Inbox
                        <span class="badge">12</span>
                    </li>
                    <li class="folder-item" onclick="selectFolder('sent')">
                        <i class="fas fa-paper-plane"></i> Sent
                    </li>
                    <li class="folder-item" onclick="selectFolder('drafts')">
                        <i class="fas fa-file"></i> Drafts
                        <span class="badge">3</span>
                    </li>
                    <li class="folder-item" onclick="selectFolder('spam')">
                        <i class="fas fa-exclamation-triangle"></i> Spam
                        <span class="badge">2</span>
                    </li>
                    <li class="folder-item" onclick="selectFolder('trash')">
                        <i class="fas fa-trash"></i> Trash
                    </li>
                </ul>
                
                <hr style="margin: 20px 0; border-color: #ecf0f1;">
                
                <ul class="folder-list">
                    <li class="folder-item" onclick="selectFolder('travelers')">
                        <i class="fas fa-users"></i> Travelers
                    </li>
                    <li class="folder-item" onclick="selectFolder('batches')">
                        <i class="fas fa-layer-group"></i> Batches
                    </li>
                    <li class="folder-item" onclick="selectFolder('payments')">
                        <i class="fas fa-credit-card"></i> Payments
                    </li>
                </ul>
            </div>
            
            <!-- Email List -->
            <div class="email-list">
                <div class="email-toolbar">
                    <div style="display: flex; gap: 10px;">
                        <input type="checkbox" id="selectAll" onclick="toggleSelectAll()">
                        <button onclick="refreshEmails()"><i class="fas fa-sync-alt"></i></button>
                        <button onclick="archiveSelected()"><i class="fas fa-archive"></i></button>
                        <button onclick="deleteSelected()"><i class="fas fa-trash"></i></button>
                        <button onclick="markAsRead()"><i class="fas fa-envelope-open"></i></button>
                        <button onclick="markAsUnread()"><i class="fas fa-envelope"></i></button>
                    </div>
                    
                    <div class="email-search">
                        <input type="text" placeholder="Search emails..." id="emailSearch">
                        <button onclick="searchEmails()"><i class="fas fa-search"></i></button>
                    </div>
                </div>
                
                <div class="email-items" id="emailItems">
                    <!-- Email Item 1 -->
                    <div class="email-item unread" onclick="openEmail(this)">
                        <input type="checkbox" class="email-checkbox" onclick="event.stopPropagation()">
                        <i class="far fa-star email-star" onclick="toggleStar(this, event)"></i>
                        <div class="email-sender">Ahmed Khan</div>
                        <div class="email-subject">Payment Confirmation</div>
                        <div class="email-preview">I have made the payment of ₹85,000 via bank transfer...</div>
                        <div class="email-date">10:30 AM</div>
                    </div>
                    
                    <!-- Email Item 2 -->
                    <div class="email-item unread" onclick="openEmail(this)">
                        <input type="checkbox" class="email-checkbox" onclick="event.stopPropagation()">
                        <i class="fas fa-star email-star" onclick="toggleStar(this, event)" style="color: #f1c40f;"></i>
                        <div class="email-sender">Fatima Begum</div>
                        <div class="email-subject">Document Submission</div>
                        <div class="email-preview">I have uploaded all the required documents as per your request...</div>
                        <div class="email-date">Yesterday</div>
                    </div>
                    
                    <!-- Email Item 3 -->
                    <div class="email-item" onclick="openEmail(this)">
                        <input type="checkbox" class="email-checkbox" onclick="event.stopPropagation()">
                        <i class="far fa-star email-star" onclick="toggleStar(this, event)"></i>
                        <div class="email-sender">Mohammed Rafiq</div>
                        <div class="email-subject">Visa Query</div>
                        <div class="email-preview">When will the visa be ready? I need to plan my travel...</div>
                        <div class="email-date">2 days ago</div>
                    </div>
                    
                    <!-- Email Item 4 -->
                    <div class="email-item" onclick="openEmail(this)">
                        <input type="checkbox" class="email-checkbox" onclick="event.stopPropagation()">
                        <i class="far fa-star email-star" onclick="toggleStar(this, event)"></i>
                        <div class="email-sender">Aisha Begum</div>
                        <div class="email-subject">Travel Insurance</div>
                        <div class="email-preview">Do we need to purchase travel insurance separately or is it included?...</div>
                        <div class="email-date">3 days ago</div>
                    </div>
                    
                    <!-- Email Item 5 -->
                    <div class="email-item" onclick="openEmail(this)">
                        <input type="checkbox" class="email-checkbox" onclick="event.stopPropagation()">
                        <i class="fas fa-star email-star" onclick="toggleStar(this, event)" style="color: #f1c40f;"></i>
                        <div class="email-sender">Omar Farooq</div>
                        <div class="email-subject">Accommodation Preference</div>
                        <div class="email-preview">I would like to request a room near the elevator due to mobility issues...</div>
                        <div class="email-date">5 days ago</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Compose Modal -->
    <div class="compose-modal" id="composeModal">
        <div class="compose-header">
            <h3>New Message</h3>
            <button class="compose-close" onclick="closeCompose()">&times;</button>
        </div>
        <div class="compose-body">
            <input type="email" id="composeTo" placeholder="To">
            <input type="text" id="composeSubject" placeholder="Subject">
            <textarea id="composeBody" placeholder="Message"></textarea>
        </div>
        <div class="compose-footer">
            <button class="action-btn btn-secondary" onclick="showTemplates()">
                <i class="fas fa-template"></i> Templates
            </button>
            <button class="action-btn btn-primary" onclick="sendEmail()">
                <i class="fas fa-paper-plane"></i> Send
            </button>
        </div>
    </div>

    <!-- Template Selector -->
    <div class="template-selector" id="templateSelector">
        <h4 style="margin-bottom: 10px;">Email Templates</h4>
        <div class="template-item" onclick="useTemplate('payment')">
            <strong>Payment Reminder</strong>
            <p style="font-size: 0.85rem; color: #7f8c8d;">Remind travelers about pending payments</p>
        </div>
        <div class="template-item" onclick="useTemplate('document')">
            <strong>Document Request</strong>
            <p style="font-size: 0.85rem; color: #7f8c8d;">Request missing documents</p>
        </div>
        <div class="template-item" onclick="useTemplate('visa')">
            <strong>Visa Update</strong>
            <p style="font-size: 0.85rem; color: #7f8c8d;">Send visa status updates</p>
        </div>
        <div class="template-item" onclick="useTemplate('welcome')">
            <strong>Welcome Email</strong>
            <p style="font-size: 0.85rem; color: #7f8c8d;">Welcome new travelers</p>
        </div>
        <div class="template-item" onclick="useTemplate('thankyou')">
            <strong>Thank You</strong>
            <p style="font-size: 0.85rem; color: #7f8c8d;">Thank travelers for their payment</p>
        </div>
    </div>

    <script>
        // Check authentication
        document.addEventListener('DOMContentLoaded', function() {
            if (!sessionStorage.getItem('adminLoggedIn')) {
                window.location.href = '/admin.login.html';
            }
        });

        function logout() {
            sessionStorage.clear();
            window.location.href = '/admin.login.html';
        }

        let currentFolder = 'inbox';

        function selectFolder(folder) {
            currentFolder = folder;
            
            document.querySelectorAll('.folder-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            showNotification(`Switched to ${folder} folder`, 'info');
            loadEmails(folder);
        }

        function loadEmails(folder) {
            // Simulate loading emails for different folders
            const emailItems = document.getElementById('emailItems');
            
            if (folder === 'inbox') {
                // Keep current inbox emails
            } else if (folder === 'sent') {
                emailItems.innerHTML = `
                    <div class="email-item" onclick="openEmail(this)">
                        <input type="checkbox" class="email-checkbox" onclick="event.stopPropagation()">
                        <i class="far fa-star email-star" onclick="toggleStar(this, event)"></i>
                        <div class="email-sender">To: Ahmed Khan</div>
                        <div class="email-subject">Payment Schedule</div>
                        <div class="email-preview">Your payment schedule for Haj Platinum 2026...</div>
                        <div class="email-date">Yesterday</div>
                    </div>
                    <div class="email-item" onclick="openEmail(this)">
                        <input type="checkbox" class="email-checkbox" onclick="event.stopPropagation()">
                        <i class="far fa-star email-star" onclick="toggleStar(this, event)"></i>
                        <div class="email-sender">To: Fatima Begum</div>
                        <div class="email-subject">Document Received</div>
                        <div class="email-preview">We have received your documents...</div>
                        <div class="email-date">2 days ago</div>
                    </div>
                `;
            } else {
                emailItems.innerHTML = '<div style="text-align: center; padding: 50px;">No emails in this folder</div>';
            }
        }

        function openCompose() {
            document.getElementById('composeModal').style.display = 'block';
        }

        function closeCompose() {
            document.getElementById('composeModal').style.display = 'none';
            document.getElementById('templateSelector').style.display = 'none';
        }

        function showTemplates() {
            const templateSelector = document.getElementById('templateSelector');
            templateSelector.style.display = templateSelector.style.display === 'block' ? 'none' : 'block';
        }

        function useTemplate(type) {
            const subject = document.getElementById('composeSubject');
            const body = document.getElementById('composeBody');
            
            const templates = {
                payment: {
                    subject: "Payment Reminder - Alhudha Haj Travel",
                    body: "Dear [Traveler Name],\n\nThis is a reminder that your next payment of ₹[Amount] is due on [Due Date]. Please make the payment at your earliest convenience.\n\nPayment Details:\nBank: XYZ Bank\nAccount: 123456789\nIFSC: XYZB0001234\n\nJazakAllah Khair,\nAlhudha Haj Travel Team"
                },
                document: {
                    subject: "Document Request - Alhudha Haj Travel",
                    body: "Dear [Traveler Name],\n\nWe need the following documents to complete your visa process:\n- Passport copy (first and last page)\n- Recent passport size photograph\n- Vaccination certificate\n- Medical fitness certificate\n\nPlease upload these documents through your traveler portal at your earliest convenience.\n\nJazakAllah Khair,\nAlhudha Haj Travel Team"
                },
                visa: {
                    subject: "Visa Update - Alhudha Haj Travel",
                    body: "Dear [Traveler Name],\n\nYour visa application status has been updated.\n\nCurrent Status: [STATUS]\n\nWe will notify you once the visa is ready for collection.\n\nJazakAllah Khair,\nAlhudha Haj Travel Team"
                },
                welcome: {
                    subject: "Welcome to Alhudha Haj Travel",
                    body: "Dear [Traveler Name],\n\nAssalamu Alaikum! Welcome to Alhudha Haj Travel.\n\nWe are pleased to have you with us for your spiritual journey. Our team will guide you through every step of the process.\n\nYour registered details:\nBatch: [Batch Name]\nDeparture: [Departure Date]\n\nPlease complete your profile and upload the required documents through your traveler portal.\n\nJazakAllah Khair,\nAlhudha Haj Travel Team"
                },
                thankyou: {
                    subject: "Thank You for Your Payment - Alhudha Haj Travel",
                    body: "Dear [Traveler Name],\n\nJazakAllah Khair for your payment of ₹[Amount]. We have received it successfully.\n\nPayment Details:\nAmount: ₹[Amount]\nDate: [Payment Date]\nTransaction ID: [Transaction ID]\n\nMay Allah accept your efforts and grant you a blessed journey.\n\nJazakAllah Khair,\nAlhudha Haj Travel Team"
                }
            };
            
            if (templates[type]) {
                subject.value = templates[type].subject;
                body.value = templates[type].body;
                document.getElementById('templateSelector').style.display = 'none';
                showNotification('Template loaded', 'success');
            }
        }

        function sendEmail() {
            const to = document.getElementById('composeTo').value;
            const subject = document.getElementById('composeSubject').value;
            const body = document.getElementById('composeBody').value;
            
            if (!to || !subject || !body) {
                showNotification('Please fill all fields', 'error');
                return;
            }
            
            showNotification('Sending email...', 'info');
            
            setTimeout(() => {
                showNotification('Email sent successfully!', 'success');
                closeCompose();
            }, 2000);
        }

        function openEmail(element) {
            element.classList.remove('unread');
            showNotification('Opening email...', 'info');
        }

        function toggleStar(element, event) {
            event.stopPropagation();
            if (element.classList.contains('fas')) {
                element.classList.remove('fas');
                element.classList.add('far');
                element.style.color = '';
            } else {
                element.classList.remove('far');
                element.classList.add('fas');
                element.style.color = '#f1c40f';
            }
        }

        function toggleSelectAll() {
            const checkboxes = document.querySelectorAll('.email-checkbox');
            const selectAll = document.getElementById('selectAll');
            
            checkboxes.forEach(cb => {
                cb.checked = selectAll.checked;
            });
        }

        function refreshEmails() {
            showNotification('Refreshing emails...', 'info');
            
            setTimeout(() => {
                showNotification('Emails refreshed', 'success');
            }, 1500);
        }

        function archiveSelected() {
            const checked = document.querySelectorAll('.email-checkbox:checked');
            if (checked.length === 0) {
                showNotification('No emails selected', 'error');
                return;
            }
            
            showNotification(`Archiving ${checked.length} email(s)...`, 'info');
            
            setTimeout(() => {
                showNotification('Emails archived', 'success');
            }, 1500);
        }

        function deleteSelected() {
            const checked = document.querySelectorAll('.email-checkbox:checked');
            if (checked.length === 0) {
                showNotification('No emails selected', 'error');
                return;
            }
            
            if (confirm(`Delete ${checked.length} email(s)?`)) {
                showNotification(`Deleting ${checked.length} email(s)...`, 'info');
                
                setTimeout(() => {
                    showNotification('Emails deleted', 'success');
                }, 1500);
            }
        }

        function markAsRead() {
            const checked = document.querySelectorAll('.email-checkbox:checked');
            checked.forEach(cb => {
                const emailItem = cb.closest('.email-item');
                if (emailItem) {
                    emailItem.classList.remove('unread');
                }
            });
            
            showNotification('Marked as read', 'success');
        }

        function markAsUnread() {
            const checked = document.querySelectorAll('.email-checkbox:checked');
            checked.forEach(cb => {
                const emailItem = cb.closest('.email-item');
                if (emailItem) {
                    emailItem.classList.add('unread');
                }
            });
            
            showNotification('Marked as unread', 'success');
        }

        function searchEmails() {
            const search = document.getElementById('emailSearch').value;
            showNotification(`Searching for: ${search}`, 'info');
        }

        function checkEmails() {
            showNotification('Checking for new emails...', 'info');
            
            setTimeout(() => {
                showNotification('No new emails', 'info');
            }, 2000);
        }

        function openSettings() {
            showNotification('Email settings coming soon', 'info');
        }

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i> ${message}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                background: ${type === 'success' ? '#27ae60' : type === 'error' ? '#e74c3c' : '#3498db'};
                color: white;
                border-radius: 5px;
                z-index: 9999;
                animation: slideIn 0.3s ease;
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Add animation style
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);

        // Close compose modal when clicking outside
        window.onclick = function(event) {
            const composeModal = document.getElementById('composeModal');
            const templateSelector = document.getElementById('templateSelector');
            
            if (event.target == composeModal) {
                closeCompose();
            }
            
            if (!event.target.closest('.template-selector') && !event.target.closest('[onclick="showTemplates()"]')) {
                templateSelector.style.display = 'none';
            }
        }
    </script>
</body>
</html>
